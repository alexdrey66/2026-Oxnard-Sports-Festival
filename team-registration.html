<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Team Pre-Registration</title>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #124175 0%, #1a5a8a 100%);
      min-height: 100%;
      color: #1e293b;
    }

    html {
      height: 100%;
    }

    .page {
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
      min-height: 100%;
      display: flex;
      flex-direction: column;
    }

    .form-container {
      background: transparent;
      border-radius: 16px;
      box-shadow: none;
      padding: 3rem;
      flex: 1;
      border: 3px solid #faca3d;
      position: relative;
    }

    .form-container::before {
      content: '';
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      background: linear-gradient(45deg, #faca3d, #124175, #faca3d);
      border-radius: 19px;
      z-index: -1;
      opacity: 0.1;
    }

    h1 {
      font-size: 3rem;
      font-weight: 900;
      text-align: center;
      margin: 0 0 1rem 0;
      color: #ffffff;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .subtitle {
      text-align: center;
      font-size: 1.1rem;
      color: #ffffff;
      margin-bottom: 2.5rem;
      line-height: 1.6;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      opacity: 0.9;
      font-style: italic;
    }

    #registrationForm {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .form-section {
      background: #124175;
      border-radius: 16px;
      padding: 2.5rem;
      border: 5px solid #faca3d;
      margin-bottom: 2rem;
      box-shadow:
        0 15px 40px rgba(18, 65, 117, 0.4),
        0 8px 20px rgba(0, 0, 0, 0.3),
        0 3px 15px rgba(250, 202, 61, 0.2);
      position: relative;
      overflow: hidden;
    }

    .form-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #faca3d 0%, #124175 50%, #faca3d 100%);
    }

    .form-section::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(250, 202, 61, 0.02) 0%, transparent 50%);
      pointer-events: none;
    }

    h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 0 0 1.5rem 0;
      color: #ffffff;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    h2::before {
      content: '';
      width: 4px;
      height: 24px;
      background: #faca3d;
      border-radius: 2px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    label {
      font-weight: 600;
      color: #ffffff;
      font-size: 0.95rem;
    }

    .required::after {
      content: ' *';
      color: #ef4444;
    }

    input, select, textarea {
      padding: 0.875rem 1rem;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.2s ease;
      background: white;
      color: #124175;
      font-family: inherit;
    }

    input::placeholder, select::placeholder, textarea::placeholder {
      color: #9ca3af;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #faca3d;
      box-shadow: 0 0 0 3px rgba(250, 202, 61, 0.2);
    }

    input:hover, select:hover, textarea:hover {
      border-color: #faca3d;
    }

    select {
      cursor: pointer;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.75rem center;
      background-repeat: no-repeat;
      background-size: 1.5em 1.5em;
      padding-right: 2.5rem;
      appearance: none;
    }

    textarea {
      resize: vertical;
      min-height: 120px;
      font-family: inherit;
    }

    #submitBtn {
      background: #faca3d;
      color: #124175;
      border: 2px solid #124175;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 700;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 1rem;
      box-shadow: 0 4px 14px 0 rgba(250, 202, 61, 0.3);
      width: 100%;
    }

    #submitBtn:hover {
      background: #124175;
      color: #faca3d;
      transform: translateY(-1px);
      box-shadow: 0 6px 20px 0 rgba(18, 65, 117, 0.4);
    }

    #submitBtn:active {
      transform: translateY(0);
    }

    #submitBtn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    #formMessage {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
      font-weight: 500;
      text-align: center;
      display: none;
    }

    .success {
      background: #dcfce7;
      color: #166534;
      border: 1px solid #bbf7d0;
    }

    .error {
      background: #fef2f2;
      color: #dc2626;
      border: 1px solid #fecaca;
    }

    @media (max-width: 768px) {
      .page {
        padding: 1rem;
      }

      .form-container {
        padding: 2rem 1.5rem;
      }

      h1 {
        font-size: 2rem;
      }

      .form-row {
        grid-template-columns: 1fr;
      }

      .subtitle {
        font-size: 1rem;
      }
    }

    @media (max-width: 480px) {
      .form-container {
        padding: 1.5rem 1rem;
      }

      h1 {
        font-size: 1.75rem;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="form-container">
      <h1>Team Pre-Registration</h1>
      <p class="subtitle">
        Complete this form to pre-register your team. Your spot is not confirmed until the Tournament Committee
        receives your PDF application, official roster, and region check.
      </p>

      <form id="registrationForm">
        <div class="form-section">
          <h2>Team Information</h2>
          <div class="form-grid">
            <div class="form-row">
              <div class="form-group">
                <label for="division" class="required">Division</label>
                <select id="division" required>
                  <option value="">Select division</option>
                  <option value="10UB">10U Boys</option>
                  <option value="10UG">10U Girls</option>
                  <option value="12UB">12U Boys</option>
                  <option value="12UG">12U Girls</option>
                  <option value="14UB">14U Boys</option>
                  <option value="14UG">14U Girls</option>
                </select>
              </div>
              <div class="form-group">
                <label for="regionNumber" class="required">Region #</label>
                <input id="regionNumber" type="number" placeholder="304" required>
              </div>
            </div>
            <div class="form-group">
              <label for="teamName" class="required">Team Name</label>
              <input id="teamName" type="text" placeholder="Falcons" required>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="city" class="required">City</label>
                <input id="city" type="text" placeholder="Oxnard" required>
              </div>
              <div class="form-group">
                <label for="state" class="required">State</label>
                <input id="state" type="text" maxlength="2" placeholder="CA" required>
              </div>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h2>Coaching Staff</h2>
          <div class="form-grid">
            <div class="form-group">
              <label for="coachName" class="required">Head Coach Name</label>
              <input id="coachName" type="text" placeholder="First Last" required>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="coachEmail" class="required">Head Coach Email</label>
                <input id="coachEmail" type="email" placeholder="name@example.com" required>
              </div>
              <div class="form-group">
                <label for="coachPhone" class="required">Head Coach Phone</label>
                <input id="coachPhone" type="tel" placeholder="805-555-1234" required>
              </div>
            </div>
            <div class="form-group">
              <label for="assistantCoach">Assistant Coach (optional)</label>
              <input id="assistantCoach" type="text" placeholder="Name">
            </div>
          </div>
        </div>

        <div class="form-section">
          <h2>Notes</h2>
          <div class="form-group">
            <label for="notes">Additional Information</label>
            <textarea id="notes" placeholder="Scheduling notes, conflict info, etc."></textarea>
          </div>
        </div>

        <button id="submitBtn" type="submit">Submit Pre-Registration</button>
        <div id="formMessage"></div>
      </form>
    </div>
  </div>

  <script>
    // Your Google Apps Script Web App URL
    const API_URL = 'https://script.google.com/macros/s/AKfycbxTgz1zRnrtYvzsJraQeDKIdw5DY6-YFgs2FI87toZE7liLc1JXRgQbYcpIcmlhVczd/exec';

    const registrationForm = document.getElementById('registrationForm');
    const messageDiv = document.getElementById('formMessage');
    const submitBtn = document.getElementById('submitBtn');

    function showMessage(text, type) {
      messageDiv.textContent = text;
      messageDiv.className = type === 'error' ? 'error' : 'success';
      messageDiv.style.display = 'block';
    }

    registrationForm.addEventListener('submit', async function (e) {
      e.preventDefault();

      const division = document.getElementById('division').value.trim();
      const regionNumber = document.getElementById('regionNumber').value.trim();
      const teamName = document.getElementById('teamName').value.trim();
      const city = document.getElementById('city').value.trim();
      const state = document.getElementById('state').value.trim();
      const coachName = document.getElementById('coachName').value.trim();
      const coachEmail = document.getElementById('coachEmail').value.trim();
      const coachPhone = document.getElementById('coachPhone').value.trim();
      const assistantCoach = document.getElementById('assistantCoach').value.trim();
      const notes = document.getElementById('notes').value.trim();

      // Basic required validation
      if (!division || !regionNumber || !teamName || !city || !state ||
          !coachName || !coachEmail || !coachPhone) {
        showMessage('Please fill in all required fields before submitting.', 'error');
        return;
      }

      const team = {
        division,
        regionNumber,
        teamName,
        city,
        state,
        coachName,
        coachEmail,
        coachPhone,
        assistantCoach,
        notes,
        docs_application: 0,
        docs_roster: 0,
        docs_check: 0,
        status: 'pending',
        internalNote: ''
      };

      // Loading state
      submitBtn.textContent = 'Submitting...';
      submitBtn.disabled = true;
      messageDiv.style.display = 'none';

      try {
        const res = await fetch(API_URL, {
          method: 'POST',
          // No Content-Type header -> avoids CORS preflight; Apps Script still gets JSON
          body: JSON.stringify({ mode: 'create', team })
        });

        const text = await res.text();
        let data;
        try {
          data = JSON.parse(text);
        } catch (err) {
          console.error('Non-JSON response from Apps Script:', text);
          showMessage('There was a problem submitting your registration. Please try again.', 'error');
          submitBtn.textContent = 'Submit Pre-Registration';
          submitBtn.disabled = false;
          return;
        }

        if (!data.ok) {
          console.error('Apps Script error:', data.error);
          showMessage('There was a problem submitting your registration. Please try again.', 'error');
          submitBtn.textContent = 'Submit Pre-Registration';
          submitBtn.disabled = false;
          return;
        }

        registrationForm.reset();
        showMessage(
          'Thank you! Your pre-registration has been received. Your team will remain in "Pending" status until all required documents and fees are confirmed by the Tournament Committee.',
          'success'
        );
      } catch (err) {
        console.error('Fetch error:', err);
        showMessage('Network error. Please check your connection and try again.', 'error');
      } finally {
        submitBtn.textContent = 'Submit Pre-Registration';
        submitBtn.disabled = false;
      }
    });

    // Real-time validation feedback (kept from Canva version)
    const requiredFields = document.querySelectorAll('input[required], select[required]');
    requiredFields.forEach(field => {
      field.addEventListener('blur', function () {
        if (!this.value.trim()) {
          this.style.borderColor = '#ef4444';
        } else {
          this.style.borderColor = '#10b981';
        }
      });

      field.addEventListener('input', function () {
        if (this.value.trim()) {
          this.style.borderColor = '#10b981';
        }
      });
    });
  </script>
</body>
</html>
