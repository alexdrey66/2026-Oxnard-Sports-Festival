<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Your CSS goes here -->
</head>
<body>

<h2>Admin â€“ Manage Teams</h2>

<input type="password" id="adminPassword" placeholder="Admin Password">
<button id="adminLoginBtn">Login</button>
<div id="adminLoginMessage"></div>

<div id="adminTools" style="display:none;">
  <table>
    <thead>
      <tr>
        <th>Division</th>
        <th>Region</th>
        <th>Team</th>
        <th>Docs</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="adminTeamsBody"></tbody>
  </table>
</div>

<script>
  const API_URL = 'https://script.google.com/macros/s/AKfycby81ycJHK0S9NUWgWuYSuHHzmz9mf2VKV_oDt4KEJv-hvSvlvOF-dxZa-AnZacewuJ8/exec';
  const ADMIN_PASSWORD = 'PLAYSOCCER';

  let teams = [];

  document.getElementById('adminLoginBtn').addEventListener('click', async () => {
    const entered = document.getElementById('adminPassword').value;
    if (entered !== ADMIN_PASSWORD) {
      document.getElementById('adminLoginMessage').innerText = "Wrong password";
      return;
    }

    document.getElementById('adminLoginMessage').innerText = "Access granted";
    document.getElementById('adminTools').style.display = "block";

    const res = await fetch(API_URL);
    teams = await res.json();
    renderAdminTable();
  });

  async function renderAdminTable() {
    const tbody = document.getElementById('adminTeamsBody');
    tbody.innerHTML = '';

    teams.forEach(team => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${team.division}</td>
        <td>${team.regionNumber}</td>
        <td>${team.teamName}</td>
        <td>
          App: ${team.docs_application} |
          Roster: ${team.docs_roster} |
          Check: ${team.docs_check}
        </td>
        <td>${team.status}</td>
        <td>
          <button onclick="updateStatus('${team.id}', 'approved')">Approve</button>
          <button onclick="updateStatus('${team.id}', 'declined')">Decline</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  async function updateStatus(id, status) {
    await fetch(API_URL, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        mode: 'update',
        team: { id, status }
      })
    });

    const res = await fetch(API_URL);
    teams = await res.json();
    renderAdminTable();
  }
</script>

</body>
</html>
